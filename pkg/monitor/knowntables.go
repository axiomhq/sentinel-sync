package monitor

import (
	"slices"
	"strings"
)

var amPrefix = "am-"

func ContainerNameToTable(containerName string) string {
	containerName = strings.TrimPrefix(containerName, amPrefix)
	if i := slices.IndexFunc(knownTables, func(s string) bool { return strings.EqualFold(containerName, s) }); i >= 0 {
		return knownTables[i]
	}
	return containerName
}

var knownTables = []string{
	"AACAudit",
	"AACHttpRequest",
	"AADB2CRequestLogs",
	"AADDomainServicesAccountLogon",
	"AADDomainServicesAccountManagement",
	"AADDomainServicesDirectoryServiceAccess",
	"AADDomainServicesDNSAuditsDynamicUpdates",
	"AADDomainServicesDNSAuditsGeneral",
	"AADDomainServicesLogonLogoff",
	"AADDomainServicesPolicyChange",
	"AADDomainServicesPrivilegeUse",
	"AADManagedIdentitySignInLogs",
	"AADNonInteractiveUserSignInLogs",
	"AADProvisioningLogs",
	"AADRiskyServicePrincipals",
	"AADRiskyUsers",
	"AADServicePrincipalRiskEvents",
	"AADServicePrincipalSignInLogs",
	"AADUserRiskEvents",
	"ABSBotRequests",
	"ACICollaborationAudit",
	"ACRConnectedClientList",
	"ACSAuthIncomingOperations",
	"ACSBillingUsage",
	"ACSCallAutomationIncomingOperations",
	"ACSCallAutomationMediaSummary",
	"ACSCallDiagnostics",
	"ACSCallRecordingIncomingOperations",
	"ACSCallRecordingSummary",
	"ACSCallSummary",
	"ACSCallSurvey",
	"ACSChatIncomingOperations",
	"ACSEmailSendMailOperational",
	"ACSEmailStatusUpdateOperational",
	"ACSEmailUserEngagementOperational",
	"ACSNetworkTraversalDiagnostics",
	"ACSNetworkTraversalIncomingOperations",
	"ACSRoomsIncomingOperations",
	"ACSSMSIncomingOperations",
	"ADAssessmentRecommendation",
	"AddonAzureBackupAlerts",
	"AddonAzureBackupJobs",
	"AddonAzureBackupPolicy",
	"AddonAzureBackupProtectedInstance",
	"AddonAzureBackupStorage",
	"ADFActivityRun",
	"ADFAirflowSchedulerLogs",
	"ADFAirflowTaskLogs",
	"ADFAirflowWebLogs",
	"ADFAirflowWorkerLogs",
	"ADFPipelineRun",
	"ADFSandboxActivityRun",
	"ADFSandboxPipelineRun",
	"ADFSSignInLogs",
	"ADFSSISIntegrationRuntimeLogs",
	"ADFSSISPackageEventMessageContext",
	"ADFSSISPackageEventMessages",
	"ADFSSISPackageExecutableStatistics",
	"ADFSSISPackageExecutionComponentPhases",
	"ADFSSISPackageExecutionDataStatistics",
	"ADFTriggerRun",
	"ADPAudit",
	"ADPDiagnostics",
	"ADPRequests",
	"ADReplicationResult",
	"ADSecurityAssessmentRecommendation",
	"ADTDataHistoryOperation",
	"ADTDigitalTwinsOperation",
	"ADTEventRoutesOperation",
	"ADTModelsOperation",
	"ADTQueryOperation",
	"ADXCommand",
	"ADXJournal",
	"ADXQuery",
	"ADXTableDetails",
	"ADXTableUsageStatistics",
	"AegDataPlaneRequests",
	"AegDeliveryFailureLogs",
	"AegPublishFailureLogs",
	"AEWAuditLogs",
	"AEWComputePipelinesLogs",
	"AgriFoodApplicationAuditLogs",
	"AgriFoodFarmManagementLogs",
	"AgriFoodFarmOperationLogs",
	"AgriFoodInsightLogs",
	"AgriFoodJobProcessedLogs",
	"AgriFoodModelInferenceLogs",
	"AgriFoodProviderAuthLogs",
	"AgriFoodSatelliteLogs",
	"AgriFoodSensorManagementLogs",
	"AgriFoodWeatherLogs",
	"AGSGrafanaLoginEvents",
	"AHDSDicomAuditLogs",
	"AHDSDicomDiagnosticLogs",
	"AHDSMedTechDiagnosticLogs",
	"AirflowDagProcessingLogs",
	"AKSAudit",
	"AKSAuditAdmin",
	"AKSControlPlane",
	"Alert",
	"AlertEvidence",
	"AlertInfo",
	"AmlComputeClusterEvent",
	"AmlComputeCpuGpuUtilization",
	"AmlComputeInstanceEvent",
	"AmlComputeJobEvent",
	"AmlDataSetEvent",
	"AmlDataStoreEvent",
	"AmlDeploymentEvent",
	"AmlEnvironmentEvent",
	"AmlInferencingEvent",
	"AmlModelsEvent",
	"AmlOnlineEndpointConsoleLog",
	"AmlOnlineEndpointEventLog",
	"AmlOnlineEndpointTrafficLog",
	"AmlPipelineEvent",
	"AmlRegistryReadEventsLog",
	"AmlRegistryWriteEventsLog",
	"AmlRunEvent",
	"AmlRunStatusChangedEvent",
	"AMSKeyDeliveryRequests",
	"AMSLiveEventOperations",
	"AMSMediaAccountHealth",
	"AMSStreamingEndpointRequests",
	"ANFFileAccess",
	"Anomalies",
	"ApiManagementGatewayLogs",
	"AppAvailabilityResults",
	"AppBrowserTimings",
	"AppCenterError",
	"AppDependencies",
	"AppEnvSpringAppConsoleLogs",
	"AppEvents",
	"AppExceptions",
	"AppMetrics",
	"AppPageViews",
	"AppPerformanceCounters",
	"AppPlatformIngressLogs",
	"AppPlatformLogsforSpring",
	"AppPlatformSystemLogs",
	"AppRequests",
	"AppServiceAntivirusScanAuditLogs",
	"AppServiceAppLogs",
	"AppServiceAuditLogs",
	"AppServiceConsoleLogs",
	"AppServiceEnvironmentPlatformLogs",
	"AppServiceFileAuditLogs",
	"AppServiceHTTPLogs",
	"AppServiceIPSecAuditLogs",
	"AppServicePlatformLogs",
	"AppServiceServerlessSecurityPluginData",
	"AppSystemEvents",
	"AppTraces",
	"ASCAuditLogs",
	"ASCDeviceEvents",
	"ASimAuditEventLogs",
	"ASimAuthenticationEventLogs",
	"ASimDnsActivityLogs",
	"ASimNetworkSessionLogs",
	"ASimNetworkSessionLogs",
	"ASimProcessEventLogs",
	"ASimWebSessionLogs",
	"ASRJobs",
	"ASRReplicatedItems",
	"ATCExpressRouteCircuitIpfix",
	"AuditLogs",
	"AutoscaleEvaluationsLog",
	"AutoscaleScaleActionsLog",
	"AVNMNetworkGroupMembershipChange",
	"AVSSyslog",
	"AWSCloudTrail",
	"AWSCloudWatch",
	"AWSGuardDuty",
	"AWSVPCFlow",
	"AZFWApplicationRule",
	"AZFWApplicationRuleAggregation",
	"AZFWDnsQuery",
	"AZFWFatFlow",
	"AZFWFlowTrace",
	"AZFWIdpsSignature",
	"AZFWInternalFqdnResolutionFailure",
	"AZFWNatRule",
	"AZFWNatRuleAggregation",
	"AZFWNetworkRule",
	"AZFWNetworkRuleAggregation",
	"AZFWThreatIntel",
	"AZKVAuditLogs",
	"AZKVPolicyEvaluationDetailsLogs",
	"AZMSApplicationMetricLogs",
	"AZMSArchiveLogs",
	"AZMSAutoscaleLogs",
	"AZMSCustomerManagedKeyUserLogs",
	"AZMSHybridConnectionsEvents",
	"AZMSKafkaCoordinatorLogs",
	"AZMSKafkaUserErrorLogs",
	"AZMSOperationalLogs",
	"AZMSRunTimeAuditLogs",
	"AZMSVnetConnectionEvents",
	"AzureAssessmentRecommendation",
	"AzureAttestationDiagnostics",
	"AzureDevOpsAuditing",
	"AzureLoadTestingOperation",
	"BehaviorAnalytics",
	"CassandraAudit",
	"CassandraLogs",
	"CCFApplicationLogs",
	"CDBCassandraRequests",
	"CDBControlPlaneRequests",
	"CDBDataPlaneRequests",
	"CDBGremlinRequests",
	"CDBMongoRequests",
	"CDBPartitionKeyRUConsumption",
	"CDBPartitionKeyStatistics",
	"CDBQueryRuntimeStatistics",
	"ChaosStudioExperimentEventLogs",
	"CHSMManagementAuditLogs",
	"CIEventsAudit",
	"CIEventsOperational",
	"CloudAppEvents",
	"CommonSecurityLog",
	"ComputerGroup",
	"ConfidentialWatchlist",
	"ConfigurationData",
	"ContainerAppConsoleLogs",
	"ContainerAppSystemLogs",
	"ContainerImageInventory",
	"ContainerInventory",
	"ContainerLog",
	"ContainerLogV2",
	"ContainerNodeInventory",
	"ContainerRegistryLoginEvents",
	"ContainerRegistryRepositoryEvents",
	"ContainerServiceLog",
	"CoreAzureBackup",
	"DatabricksAccounts",
	"DatabricksCapsule8Dataplane",
	"DatabricksClamAVScan",
	"DatabricksClusterLibraries",
	"DatabricksClusters",
	"DatabricksDBFS",
	"DatabricksDeltaPipelines",
	"DatabricksFeatureStore",
	"DatabricksGenie",
	"DatabricksGitCredentials",
	"DatabricksGlobalInitScripts",
	"DatabricksIAMRole",
	"DatabricksInstancePools",
	"DatabricksJobs",
	"DatabricksMLflowAcledArtifact",
	"DatabricksMLflowExperiment",
	"DatabricksModelRegistry",
	"DatabricksNotebook",
	"DatabricksPartnerHub",
	"DatabricksRemoteHistoryService",
	"DatabricksRepos",
	"DatabricksSecrets",
	"DatabricksServerlessRealTimeInference",
	"DatabricksSQLPermissions",
	"DatabricksSSH",
	"DatabricksUnityCatalog",
	"DatabricksWebTerminal",
	"DatabricksWorkspace",
	"DataTransferOperations",
	"DevCenterDiagnosticLogs",
	"DeviceEvents",
	"DeviceFileCertificateInfo",
	"DeviceFileEvents",
	"DeviceImageLoadEvents",
	"DeviceInfo",
	"DeviceLogonEvents",
	"DeviceNetworkEvents",
	"DeviceNetworkInfo",
	"DeviceProcessEvents",
	"DeviceRegistryEvents",
	"DeviceTvmSecureConfigurationAssessment",
	"DeviceTvmSecureConfigurationAssessmentKB",
	"DeviceTvmSoftwareInventory",
	"DeviceTvmSoftwareVulnerabilities",
	"DeviceTvmSoftwareVulnerabilitiesKB",
	"DnsEvents",
	"DnsInventory",
	"DSMAzureBlobStorageLogs",
	"DSMDataClassificationLogs",
	"DSMDataLabelingLogs",
	"DynamicEventCollection",
	"Dynamics365Activity",
	"DynamicSummary",
	"EmailAttachmentInfo",
	"EmailEvents",
	"EmailPostDeliveryEvents",
	"EmailUrlInfo",
	"EnrichedMicrosoft365AuditLogs",
	"Event",
	"ExchangeAssessmentRecommendation",
	"ExchangeOnlineAssessmentRecommendation",
	"FailedIngestion",
	"FunctionAppLogs",
	"GCPAuditLogs",
	"HDInsightAmbariClusterAlerts",
	"HDInsightAmbariSystemMetrics",
	"HDInsightGatewayAuditLogs",
	"HDInsightHadoopAndYarnLogs",
	"HDInsightHadoopAndYarnMetrics",
	"HDInsightHBaseLogs",
	"HDInsightHBaseMetrics",
	"HDInsightHiveAndLLAPLogs",
	"HDInsightHiveAndLLAPMetrics",
	"HDInsightHiveQueryAppStats",
	"HDInsightHiveTezAppStats",
	"HDInsightJupyterNotebookEvents",
	"HDInsightKafkaLogs",
	"HDInsightKafkaMetrics",
	"HDInsightOozieLogs",
	"HDInsightRangerAuditLogs",
	"HDInsightSecurityLogs",
	"HDInsightSparkApplicationEvents",
	"HDInsightSparkBlockManagerEvents",
	"HDInsightSparkEnvironmentEvents",
	"HDInsightSparkExecutorEvents",
	"HDInsightSparkExtraEvents",
	"HDInsightSparkJobEvents",
	"HDInsightSparkLogs",
	"HDInsightSparkSQLExecutionEvents",
	"HDInsightSparkStageEvents",
	"HDInsightSparkStageTaskAccumulables",
	"HDInsightSparkTaskEvents",
	"HDInsightStormLogs",
	"HDInsightStormMetrics",
	"HDInsightStormTopologyMetrics",
	"HealthStateChangeEvent",
	"Heartbeat",
	"HuntingBookmark",
	"IdentityDirectoryEvents",
	"IdentityInfo",
	"IdentityLogonEvents",
	"IdentityQueryEvents",
	"InsightsMetrics",
	"IntuneAuditLogs",
	"IntuneDevices",
	"IntuneOperationalLogs",
	"KubeEvents",
	"KubeHealth",
	"KubeMonAgentEvents",
	"KubeNodeInventory",
	"KubePodInventory",
	"KubePVInventory",
	"KubeServices",
	"LAQueryLogs",
	"LogicAppWorkflowRuntime",
	"McasShadowItReporting",
	"MCCEventLogs",
	"MCVPAuditLogs",
	"MCVPOperationLogs",
	"MicrosoftAzureBastionAuditLogs",
	"MicrosoftDataShareReceivedSnapshotLog",
	"MicrosoftDataShareSentSnapshotLog",
	"MicrosoftGraphActivityLogs",
	"MicrosoftHealthcareApisAuditLogs",
	"MicrosoftPurviewInformationProtection",
	"NetworkAccessTraffic",
	"NSPAccessLogs",
	"NTAIpDetails",
	"NTANetAnalytics",
	"NTATopologyDetails",
	"NWConnectionMonitorDestinationListenerResult",
	"NWConnectionMonitorPathResult",
	"NWConnectionMonitorTestResult",
	"OEPAirFlowTask",
	"OEPAuditLogs",
	"OEPDataplaneLogs",
	"OEPElasticOperator",
	"OEPElasticsearch",
	"OfficeActivity",
	"OLPSupplyChainEntityOperations",
	"OLPSupplyChainEvents",
	"Operation",
	"Perf",
	"PFTitleAuditLogs",
	"PowerAppsActivity",
	"PowerAutomateActivity",
	"PowerBIActivity",
	"PowerBIAuditTenant",
	"PowerBIDatasetsTenant",
	"PowerBIDatasetsWorkspace",
	"PowerBIReportUsageWorkspace",
	"PowerPlatformConnectorActivity",
	"PowerPlatformDlpActivity",
	"ProjectActivity",
	"PurviewDataSensitivityLogs",
	"PurviewScanStatusLogs",
	"PurviewSecurityLogs",
	"REDConnectionEvents",
	"ResourceManagementPublicAccessLogs",
	"SCCMAssessmentRecommendation",
	"SCOMAssessmentRecommendation",
	"SecureScoreControls",
	"SecureScores",
	"SecurityAlert",
	"SecurityBaseline",
	"SecurityBaselineSummary",
	"SecurityDetection",
	"SecurityEvent",
	"SecurityIncident",
	"SecurityIoTRawEvent",
	"SecurityNestedRecommendation",
	"SecurityRecommendation",
	"SecurityRegulatoryCompliance",
	"SentinelAudit",
	"SentinelHealth",
	"SharePointOnlineAssessmentRecommendation",
	"SignalRServiceDiagnosticLogs",
	"SigninLogs",
	"SPAssessmentRecommendation",
	"SQLAssessmentRecommendation",
	"SQLSecurityAuditEvents",
	"SqlVulnerabilityAssessmentScanStatus",
	"StorageBlobLogs",
	"StorageCacheOperationEvents",
	"StorageCacheUpgradeEvents",
	"StorageCacheWarningEvents",
	"StorageFileLogs",
	"StorageMalwareScanningResults",
	"StorageMoverCopyLogsFailed",
	"StorageMoverCopyLogsTransferred",
	"StorageMoverJobRunLogs",
	"StorageQueueLogs",
	"StorageTableLogs",
	"SucceededIngestion",
	"SynapseBigDataPoolApplicationsEnded",
	"SynapseBuiltinSqlPoolRequestsEnded",
	"SynapseDXFailedIngestion",
	"SynapseDXSucceededIngestion",
	"SynapseGatewayApiRequests",
	"SynapseIntegrationActivityRuns",
	"SynapseIntegrationPipelineRuns",
	"SynapseIntegrationTriggerRuns",
	"SynapseLinkEvent",
	"SynapseRbacOperations",
	"SynapseScopePoolScopeJobsEnded",
	"SynapseScopePoolScopeJobsStateChange",
	"SynapseSqlPoolDmsWorkers",
	"SynapseSqlPoolExecRequests",
	"SynapseSqlPoolRequestSteps",
	"SynapseSqlPoolSqlRequests",
	"SynapseSqlPoolWaits",
	"Syslog",
	"ThreatIntelligenceIndicator",
	"TSIIngress",
	"UCClient",
	"UCClientReadinessStatus",
	"UCClientUpdateStatus",
	"UCDeviceAlert",
	"UCDOAggregatedStatus",
	"UCDOStatus",
	"UCServiceUpdateStatus",
	"UCUpdateAlert",
	"Update",
	"UpdateRunProgress",
	"UpdateSummary",
	"UrlClickEvents",
	"Usage",
	"UserAccessAnalytics",
	"UserPeerAnalytics",
	"VIAudit",
	"VIIndexing",
	"W3CIISLog",
	"WaaSDeploymentStatus",
	"WaaSInsiderStatus",
	"WaaSUpdateStatus",
	"Watchlist",
	"WebPubSubConnectivity",
	"WebPubSubHttpRequest",
	"WebPubSubMessaging",
	"WindowsClientAssessmentRecommendation",
	"WindowsEvent",
	"WindowsFirewall",
	"WindowsServerAssessmentRecommendation",
	"WireData",
	"WorkloadDiagnosticLogs",
	"WUDOAggregatedStatus",
	"WUDOStatus",
	"WVDAgentHealthStatus",
	"WVDCheckpoints",
	"WVDConnectionNetworkData",
	"WVDConnections",
	"WVDErrors",
	"WVDFeeds",
	"WVDHostRegistrations",
	"WVDManagement",
}
